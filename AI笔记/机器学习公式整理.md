# 机器学习公式



## 一、最小二乘法

用最小二乘法，求得平均误差ε：
$$
ε=\frac{1}{m}\sum_{i=0}^m|yi'-yi|^2
$$

[^注]: 其中用yi'代替yi^(预测值)，yi是实际值。



## 二、线性回归

### 1、模型

- 一元一次：

$$
y=a*x+b
$$

- 多元线性回归：

$$
y=w0+w1*x1+...+wn*xn
$$

[^注]: 其中，x为特征，w为权重；x0恒等于1，w0为截距；



### 2、概率密度函数

```
概率密度函数可以基于：均匀分布、正态分布、泊松分布等，但会影响损失函数
```

- 基于均匀分布：

$$
f(x)=\frac{1}{b-a}
$$

- 基于正态分布：

$$
f(x)=\frac{1}{σ\sqrt{2π}}e^{-\frac{(x-μ)^2}{2σ^2}}
$$



## 三、求解多元线性回归

### 1、最大总似然估计

$$
L(θ)=\prod_{i=1}^m\frac{1}{σ\sqrt{2π}}exp(-\frac{(y^{(i)}-θ^Tx^{(i)})^2}{2σ^2})
$$

[^注]: 由公式中的误差代入概率密度函数而得到



### 2、损失函数的推导

- 求对数更易于得出最小时刻

$$
l(θ)=logL(θ)=mlog\frac{1}{σ\sqrt{2π}}-\frac{1}{σ^2}.\frac{1}{2}\sum_{i=1}^m(y^{(i)}-θ^Tx{(i)})^2
$$



- 损失函数：

$$
J(θ)=\frac{1}{2}\sum_{i=1}^m(h_θ(x^{(i)})-y^{(i)})^2=\frac{1}{2}(Xθ-y)^T(Xθ-y)
$$

$$
J(θ)=\frac{1}{2}(Xθ-y)^T(Xθ-y)=\frac{1}{2}(X^Tθ^TXθ-X^Tθ^T-y^TXθ+y^Ty)
$$

[^注]: 上边为代数形式，下边为线性代数形式



### 3、最优解析解θ

由J(θ)求导=0解得θ
$$
θ=(X^TX)^{-1}X^Ty
$$



### 4、梯度下降法（求梯度）

#### 基本方式

- J(θ)求导求梯度

$$
gradients=X^T(Xθ-y)
$$

$$
gradient_j=x_j^T(Xθ-y)
$$

```
注：上面为梯度向量，下面为j维度（特征）的梯度
```

- 调整θ

$$
θ^{t+1}=θ^{t}-gradient*η
$$

[^注]: η为学习率。

#### 批量梯度下降

$$
gradients=\frac{1}{m}X^T(Xθ-y)
$$

#### 随机梯度下降

- 调整梯度

$$
gradients=x_i^T*(θ*x_i-y_i)
$$

[^注]: i为随机到的某个样本

- 调整θ

$$
for\ i=\ 1\ to\ m,\{\ θ_j:=θ_j+α(y^{(i)}-θ*x^{(i)})x_j^{(i)}\ \}
$$



### 5、线性回归算法选择

#### Ridge Regression

$$
\min_{w} {({|| X w - y||_2}^2 + \alpha {||w||_2}^2)}
$$

[^注]: Ridges损失函数 = 原先损失函数 + α*w平方和

#### Lasso Regression

$$
\min_{w} {( \frac{1}{2m} ||X w - y||_2 ^ 2 + \alpha ||w||_1)}
$$

[^注]: Lasso损失函数 = 原先损失函数 + α*w绝对值的和

#### Elastic Net

$$
\min_{w} { (\frac{1}{2m} ||X w - y||_2 ^ 2 + \alpha \rho ||w||_1 +
\frac{\alpha(1-\rho)}{2} ||w||_2 ^ 2)}
$$

[^注]: Elastic Net损失函数 = 原先损失函数 + α\*w绝对值的和 + α\*w平方和
[^注]: ρ = l1_ratio；αρ：表示L1正则权重；α(1-ρ)/2：表示L2正则权重；



## 四、逻辑回归

### 1、基本公式

$$
\begin{equation}
\begin{cases}
z=w0+w1*x1+...+wn*xn，多元线性回归
\\
p'=σ(z)=\frac{1}{1+e^{-z}}，缩放到[0,1]，计算概率
\end{cases}
\end{equation}
$$

### 2、交叉熵

$$
-qlog(p)
$$

[^注]: 来自信息论，可在机器学习中作为损失函数，其中p为真实值，q为预测值

### 3、逻辑回归求解

- 阈值为0.5

$$
y'=
\begin{equation}
\begin{cases}
0,\ if\ p'<0.5,\\
1,\ if\ p'>0.5.\\
\end{cases}
\end{equation}
$$

- 误差函数

$$
c(θ)=
\begin{equation}
\begin{cases}
-log(p'),\ if\ y=1,\\
-log(1-p'),\ if\ y=0.\\
\end{cases}
\end{equation}
$$

- 损失函数

$$
J(θ)=-\frac{1}{m}\sum_{i=1}^m[y^{(i)}log(p'^{(i)})+(1-y^{(i)})log(1-p'^{(i)})]
$$

- 求偏导


$$
\frac{∂}{∂θ_j}J(θ)=\frac{1}{m}\sum_{i=1}^m(σ(θ^T*x^{(i)})-y^{(i)})x_j^{(i)}
$$







